---
title: '(AWS시리즈8) EC2 서버에 프로젝트 배포'
date: 2020-09-16 17:10:00
category: 'aws'
draft: false
---

# 코드가 푸시되면 자동으로 배포

- 24시간 365일 운영되는 서비스에서 배포 환경 구축은 필수 과제 중 하나
- 우리 개발자의 코드가 실시간으로 병합되고, 테스트가 수행되는 환경, master 브랜치가 푸시되면 배포가 자동으로 이루어지는 환경을 구축하지 않으면 실수할 여지가 너무 많다.

## CI & CD 란

- `CI(Continuous Integration - 지속적 통합)` 은 코드 버전 관리를 하는 VCS 시스템(Git, SVN 등)에 PUSH가 되면 자동으로 테스트와 빌드가 수행되어 안정적인 배포 파일을 만드는 과정
- `CD(Continuous Deployment - 지속적인 배포)` 은 위의 빌드 결과를 자동으로 운영 서버에 무중단 배포까지 진행하는 과정
- 일반적으로 CI만 독립적으로 구축되어 있지는 않고 CD는 함께 구축된 경우가 많다.
- CI와 CD의 배경

  - 협업하는 웹 개발 과정에서 매주 코드 병합일을 정하여 코드를 합치는 일을 했었는데, 이 수작업은 효율이 좋지 않았다.
  - 그래서 개발자들은 지속해서 코드가 통합되는 환경(CI)을 구축하게 되었고, 개발자 각자가 원격 저장소(ex. 깃허브) 로 푸시가 될 때마다 코드를 병합하고, 테스트 코드와 빌드를 수행하면서 자동으로 코드가 병합되어 더는 수동으로 코드를 통합할 필요가 없어지면서 개발에만 집중 가능
  - CD 역시 마찬가지. 한두 대의 서버에 개발자가 수동으로 배포를 할 수 있지만, 수백 대의 서버에 배포하거나 긴박하게 배포를 해야 하는 상황에서는 더는 수동으로 배포를 할 수 없는 상황. 그래서 `자동화`. 이 덕에 개발에만 집중 가능
  - `주의할 점`은 단순히 CI 도구를 도입했다고 해서 CI를 하고 있는 것이 아니다라는 것. CI에 대해 4가지 규칙이 중요

    1. 모든 소스 코드가 살아 있고(현재 실행되고), 누구든 현재의 소스에 접근할 수 있는 단일지점을 유지할 것
    2. 빌드 프로세스를 자동화해서 누구든 소스로부터 시스템을 빌드하는 단일 명령어를 사용할 수 있게 할 것
    3. `테스팅을 자동화`해서 단일 명령어로 언제든지 시스템에 대한 건전한 테스트 수트를 실행할 수 있게 한 것
    4. 누구나 현재 실행 파일을 얻으면 지금까지 가장 완전한 실행 파일을 얻었다는 확신을 할 것

    - 4가지 중에서 `테스팅 자동화`가 가장 주요. 지속통합을 위해서는 이 프로젝트가 완전한 상태임을 보장하기 위해 테스트 코드가 구현되어 있어야만 하기 때문이다.

## Travis CI 연동하기

- Travis CI는 깃허브에서 제공하는 무료 CI 서비스이다. 젠킨스와 같은 CI 도구도 있으나, 젠킨스는 설치형이므로 이를 위한 EC2 인스턴스가 하나 더 필요하다. 오픈소스 웹 서비스인 Travis CI를 사용

- Travis CI 웹 서비스 설정
-
